/* css/style.css */

/* --- 기본 스타일 --- */
:root {
    --bg-main: #fcfbf6;
    --bg-panel: #ffffff;
    --bg-panel-side: #f5f5ea;
    --border-color: #d5d5c6;
    --border-color-light: #deded0;
    --font-family: '맑은 고딕', sans-serif;
    --title-color: #333;
    --highlight-color: #ffc107;
    --gantt-active-bg: #a7d7b5;
    
    /* [수정됨] 경고색 변수 정의 (노란색/빨간색) */
    --color-danger-bg: #FFD2D2; /* 불용/초과 인원 배경색 (연한 빨강) */
    --color-warning-bg: #FFFACD; /* 병목/부족 인원 배경색 (연한 노랑) */
}
html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
    font-size: 14px;
}
body { font-family: var(--font-family); background: var(--bg-main); }
#container { display: flex; flex-direction: column; height: 100%; }
.page-wrapper { flex: 1; display: flex; flex-direction: column; min-height: 0; }

/* --- 메인 네비게이션 --- */
#main-nav {
    display: flex;
    background-color: #333;
    padding: 0 20px;
    flex-shrink: 0;
}
#main-nav a {
    color: white;
    padding: 14px 20px;
    text-decoration: none;
    text-align: center;
    font-weight: bold;
}
#main-nav a:hover {
    background-color: #555;
}
#main-nav a.active {
    background-color: var(--highlight-color);
    color: #333;
}

/* --- 페이지 컨텐츠 공통 --- */
.page-content {
    display: flex;
    flex-direction: column;
    flex-grow: 1;
    padding: 15px 25px;
    box-sizing: border-box;
    overflow-y: auto;
}
.panel-title {
    font-size: 18px;
    font-weight: 600;
    color: var(--title-color);
    margin: 0 0 10px 0;
    padding-bottom: 8px;
    border-bottom: 2px solid #eee;
}
.toolbar {
    margin-bottom: 12px;
    flex-shrink: 0;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    align-items: center;
}
.toolbar button {
    font-size: 13px;
    background: #eef;
    border: 1px solid #bbb;
    padding: 5px 10px;
    border-radius: 4px;
    cursor: pointer;
}
.toolbar input[type="file"] { font-size: 13px; }
.attr-table-scroll {
    overflow: auto;
    flex-grow: 1;
}

/* --- 1페이지 스타일 --- */
#page1 { gap: 15px; }
.tree-block {
    flex: 1 1 48%;
    border: 1px solid var(--border-color);
    background: var(--bg-panel);
    display: flex;
    flex-direction: column;
    min-height: 350px;
    padding: 15px;
    border-radius: 5px;
}
.treepanel {
    display: flex;
    width: 100%;
    flex: 1;
    overflow: hidden;
    border-top: 1px solid #eee;
    margin-top: 10px;
}
.tree-side {
    flex: 0 0 40%;
    min-width: 250px;
    max-width: 600px;
    border-right: 2px solid var(--border-color-light);
    background: #fdfdfa;
    height: 100%;
    overflow-y: auto;
    padding-top: 10px;
}
.attr-side { flex: 1 1 60%; height: 100%; overflow: auto; }
table { border-collapse: collapse; background: white; width: 100%; }
th, td { border: 1px solid #ddd; font-size: 12px; padding: 6px 8px; text-align: center; white-space: nowrap; vertical-align: middle; }
th { background: #faf4e4; }
td input[type="text"], td input[type="number"] { width: 100%; box-sizing: border-box; border: 0; background: none; font: inherit; font-size: 12px; text-align: left; padding: 2px; }
.tree-row.selected > td { background-color: var(--color-warning-bg); }

/* --- 2페이지 스타일 --- */
#page2 { flex-direction: row; gap: 20px; }
.column-panel { display: flex; flex-direction: column; min-width: 0; min-height: 0; }
#page2 > .column-panel:nth-child(1) { flex: 3; }
#page2 > .column-panel:nth-child(2) { flex: 1.5; }
#jobPanel, #weatherPanel {
    background: #f7f9fc;
    border: 1px solid #d8deeb;
    border-radius: 8px;
    padding: 24px;
    display: flex;
    flex-direction: column;
    height: 100%;
    box-sizing: border-box;
}
#jobPanel .attr-table-scroll, #weatherPanel .attr-table-scroll { flex: 1; overflow: auto; margin-top: 10px; min-height: 0; }
#jobPanel th, #weatherPanel th { background: #eaf2fa; }
#weatherPanel th.col-site { cursor: pointer; }
#weatherPanel th.selected { background-color: #007bff !important; color: white !important; }
#weatherTableWrap table th:first-child, #weatherTableWrap table td:first-child { min-width: 95px; }

/* [수정] 날씨 테이블 너비 자동 조절 */
#weatherPanel table {
    width: auto;
}

/* 날씨 테이블 경고색 스타일 */
#weatherTableWrap tr.bottleneck-warning td {
    background-color: var(--color-warning-bg) !important;
}
#weatherTableWrap tr.unused-worker-alert td {
    background-color: var(--color-danger-bg) !important;
}


/* --- 3페이지 스타일 --- */
#page3 { flex-direction: column; gap: 15px; }
#page3-top-panel { flex: 1; min-height: 0; display: flex; gap: 15px; }
#viewer-panel { flex: 3; display: flex; flex-direction: column; min-width: 0; }
#viewer-container { flex: 1; position: relative; background-color: #333; border-radius: 8px; border: 1px solid #ccc; min-height: 200px; }
#properties-panel { flex: 1.2; display: flex; flex-direction: column; border: 1px solid #d8deeb; background: #f7f9fc; border-radius: 8px; padding: 15px 24px; box-sizing: border-box; overflow-y: auto; }
.prop-table { width: 100%; margin-top: 10px; border-collapse: collapse; }
.prop-table th, .prop-table td { background: white; text-align: left; padding: 6px 8px; font-size: 13px; border: 1px solid #eee; }
.prop-table th { background: #f8f9fa; font-weight: 600; width: 110px; }
#gantt-container { flex-shrink: 0; height: 45%; max-height: 500px; display: flex; flex-direction: column; border: 1px solid #d8deeb; background: #f7f9fc; border-radius: 8px; padding: 15px 24px; box-sizing: border-box; }

/* =================================================== */
/*           간트 차트 스크롤 고정 및 스타일             */
/* =================================================== */
#gantt-table-wrap { 
    flex: 1; 
    overflow: auto; 
    margin-top: 10px; 
    padding-bottom: 30px;
    box-sizing: border-box;
}
#gantt-table-wrap table { 
    table-layout: fixed; 
    border-collapse: collapse; 
    width: 100%;
}

/* --- 상단 헤더 고정 (수직 스크롤) --- */
#gantt-table-wrap thead th { 
    position: sticky; 
    background: #eaf2fa; 
    z-index: 2;
}
/* [수정] 간트 차트 행 높이 변경에 따른 sticky 헤더 top 위치 조정 */
#gantt-table-wrap .gantt-header-row-0 th { top: 0; }
#gantt-table-wrap .gantt-header-row-1 th { top: 25px; }
#gantt-table-wrap .gantt-header-row-2 th { top: 50px; }
#gantt-table-wrap .gantt-header-row-3 th { top: 75px; }

/* --- 좌측 열 고정 (수평 스크롤) --- */
#gantt-table-wrap tbody td.col-check,
#gantt-table-wrap tbody td.col-name,
#gantt-table-wrap tbody td.col-job {
    position: sticky;
    background: #f7f9fc;
    z-index: 1;
}
#gantt-table-wrap .col-check { left: 0; }
#gantt-table-wrap .col-name  { left: 40px; }
#gantt-table-wrap .col-job   { left: 290px; }

/* --- 교차점 (Top-Left Corner) 고정 --- */
#gantt-table-wrap thead th.col-check,
#gantt-table-wrap thead th.col-name,
#gantt-table-wrap thead th.col-job {
    z-index: 3 !important;
}

/* --- 나머지 간트 스타일 --- */
/* [수정] 간트 차트 행(바) 높이 20px -> 24px로 조정 */
#gantt-table-wrap td, #gantt-table-wrap th { 
    border: 1px solid #ddd; 
    font-size: 11px; 
    padding: 0; 
    text-align: center; 
    vertical-align: middle; 
    height: 24px;
}
#gantt-table-wrap .gantt-hour-cell { 
    min-width: 15px; 
    width: 15px; 
    border-left: 1px dotted #e0e0e0;
}
#gantt-table-wrap .gantt-hour-cell.active { 
    background-color: var(--gantt-active-bg); 
    position: relative;
    z-index: 1;
}
#gantt-table-wrap .gantt-day-divider { 
    border-right: 1px solid #ccc !important; 
}
#gantt-table-wrap .col-name { min-width: 250px; width: 250px; text-align: left; font-size: 12px; padding: 4px 7px; }
#gantt-table-wrap .col-check { min-width: 40px; width: 40px; }
#gantt-table-wrap .col-job { min-width: 200px; width: 200px; text-align: left; font-size: 12px; vertical-align: middle; padding: 4px 8px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
#gantt-table-wrap tr.gantt-row:hover td { background-color: #f0f4f8; }
#gantt-table-wrap tr.gantt-row:hover td.col-check,
#gantt-table-wrap tr.gantt-row:hover td.col-name,
#gantt-table-wrap tr.gantt-row:hover td.col-job {
    background-color: #e6ecf2;
}
#gantt-table-wrap tr.gantt-row { cursor: pointer; }
#gantt-table-wrap tr.selected-row td { background-color: var(--highlight-color) !important; color: black; }
#gantt-table-wrap .status-indicator { display: inline-block; width: 14px; height: 14px; border-radius: 50%; border: 1px solid #999; vertical-align: middle; margin: 0 auto; cursor: pointer; }
#gantt-table-wrap .status-indicator.on { background-color: #ffc107; border-color: #e0a800; }
#gantt-table-wrap .status-indicator.off { background-color: transparent; }
#gantt-table-wrap .status-indicator.unlinked { background-color: #eee; border-color: #ddd; cursor: default; }


/* --- 4페이지 스타일 --- */
#page4.page-content { height: 100%; overflow: hidden; display: flex; flex-direction: column; gap: 15px; }
#p4-top-section { display: flex; flex-direction: row; gap: 15px; flex-shrink: 0; }
#p4-bottom-section { flex: 1; display: flex; flex-direction: column; min-height: 0; }
.panel-container { background: #f7f9fc; border: 1px solid #d8deeb; border-radius: 8px; padding: 20px; display: flex; flex-direction: column; }
#daily-work-panel { flex: 8; overflow-y: auto; }
#daily-status-table { width: 100%; table-layout: fixed; border-collapse: collapse; }
#daily-status-table th, #daily-status-table td { border: 1px solid #ddd; padding: 8px; text-align: center; font-size: 14px; vertical-align: middle; }
#daily-status-table th { background-color: #eaf2fa; }
#daily-status-table input, #daily-status-table select { width: 95%; box-sizing: border-box; font-size: 14px; text-align: center; padding: 2px; }
#daily-status-table .apply-btn { padding: 4px 10px; cursor: pointer; font-size: 13px; }
#daily-status-table th:last-child, #daily-status-table td:last-child { width: 70px; }

/* --- 캘린더 스타일 --- */

/* --- 4페이지 간트 차트 스타일 --- */
#gantt-panel-p4 { flex-grow: 1; display: flex; flex-direction: column; min-height: 0; }
#p4-gantt-container { 
    overflow: auto; 
    flex-grow: 1; 
    padding-bottom: 30px;
    box-sizing: border-box;
}
#p4-gantt-container table { border-collapse: collapse; width: 100%; table-layout: fixed; }
/* [수정] 간트 차트 행(바) 높이 20px -> 24px로 조정 */
#p4-gantt-container th, #p4-gantt-container td { border: 1px solid #ddd; text-align: center; font-size: 11px; white-space: nowrap; vertical-align: middle; padding: 0; height: 24px; }
#p4-gantt-container thead th { position: sticky; background: #eaf2fa; z-index: 2; }
/* [수정] 간트 차트 행 높이 변경에 따른 sticky 헤더 top 위치 조정 */
#p4-gantt-container .gantt-header-row-0 th { top: 0; }
#p4-gantt-container .gantt-header-row-1 th { top: 25px; }
#p4-gantt-container .gantt-header-row-2 th { top: 50px; }
#p4-gantt-container .gantt-header-row-3 th { top: 75px; }
#p4-gantt-container .col-name, #p4-gantt-container .col-job, #p4-gantt-container .col-division { position: sticky; z-index: 1; background: #f7f9fc; }
#p4-gantt-container .col-name { left: 0; width: 250px; text-align: left !important; padding-left: 10px !important; }
#p4-gantt-container .col-job { left: 250px; width: 200px; text-align: left !important; padding-left: 8px !important; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}
#p4-gantt-container .col-division { left: 450px; width: 60px; font-weight: bold; }
#p4-gantt-container thead th.col-name, #p4-gantt-container thead th.col-job, #p4-gantt-container thead th.col-division { z-index: 3 !important; }
#p4-gantt-container .gantt-hour-cell { width: 15px !important; min-width: 15px !important; border-left: 1px dotted #e0e0e0; }
#p4-gantt-container .gantt-day-divider { border-right: 1px solid #ccc !important; }
#p4-gantt-container tr.gantt-row:hover > td, #p4-gantt-container tr.sub-row:hover > td { background-color: #f0f4f8; }
#p4-gantt-container tr:hover > td.col-name, #p4-gantt-container tr:hover > td.col-job, #p4-gantt-container tr:hover > td.col-division { background-color: #e6ecf2; }
#p4-gantt-container tr.selected-row > td { background-color: #fffbe0 !important; }
.plan-label { color: #28a745; }
.actual-label { color: #dc3545; }
.active-plan { background-color: #a7d7b5; position: relative; z-index: 1; }
.active-actual { background-color: #f5c6cb; position: relative; z-index: 1; }
.sub-row td { border-top-width: 0; }

/* 간트 차트 휴일 배경색 스타일 */
#gantt-table-wrap th.holiday-header,
#p4-gantt-container th.holiday-header {
    background-color: var(--color-warning-bg);
}
#gantt-table-wrap .holiday-cell,
#p4-gantt-container .holiday-cell {
    background-color: #FFFEEB;
}


/* --- 모달 공통 스타일 --- */
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: none; justify-content: center; align-items: center; z-index: 1000; }
.modal-content { background-color: white; padding: 25px 30px; border-radius: 8px; width: 400px; max-height: 80vh; box-shadow: 0 5px 15px rgba(0,0,0,0.3); display: flex; flex-direction: column; }
.modal-title { font-size: 18px; font-weight: bold; margin-bottom: 15px; }
.modal-body { flex: 1; overflow-y: auto; border-top: 1px solid #eee; border-bottom: 1px solid #eee; padding: 15px 5px; }
.modal-footer { text-align: right; margin-top: 20px; display: flex; justify-content: flex-end; gap: 10px; }
.modal-footer button { padding: 8px 16px; border-radius: 5px; cursor: pointer; border: none; font-weight: bold; }
.btn-confirm { background-color: #007bff; color: white; }
.btn-cancel { background-color: #6c757d; color: white; }
#workforce-optimization-modal .modal-footer { display: flex; justify-content: center; }
#workforce-optimization-modal .modal-body hr { border: 0; border-top: 1px solid #eee; }

/* 휴일 셀 스타일 */
td.holiday {
  background-color: #ffe5e5 !important;
}

/* 실적 바 스타일 - 파란색 */
.actual-bar {
  background-color: #4A90E2 !important;
}